<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Perform IP address translation."><title>address_translation in libp2p::core - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="libp2p" data-themes="" data-resource-suffix="" data-rustdoc-version="1.91.1 (ed61e7d7e 2025-11-07)" data-channel="1.91.1" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-263c88ec.css"></noscript><link rel="icon" href="https://libp2p.io/img/favicon.png"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">address_translation</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../libp2p/index.html"><img src="https://libp2p.io/img/logo_small.png" alt="logo"></a><h2><a href="../../libp2p/index.html">libp2p</a><span class="version">0.52.4</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"><h2><a href="index.html">In libp2p::<wbr>core</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">libp2p</a>::<wbr><a href="index.html">core</a></div><h1>Function <span class="fn">address_<wbr>translation</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/libp2p_core/translation.rs.html#38">Source</a> </span></div><pre class="rust item-decl"><code>pub fn address_translation(
    original: &amp;<a class="struct" href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr">Multiaddr</a>,
    observed: &amp;<a class="struct" href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr">Multiaddr</a>,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.91.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr">Multiaddr</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Perform IP address translation.</p>
<p>Given an <code>original</code> <a href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr"><code>Multiaddr</code></a> and some <code>observed</code> <a href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr"><code>Multiaddr</code></a>, replace the first protocol
of the <code>original</code> with the first protocol of the <code>observed</code> <a href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr"><code>Multiaddr</code></a> and return this
translated <a href="../struct.Multiaddr.html" title="struct libp2p::Multiaddr"><code>Multiaddr</code></a>.</p>
<p>This function can for example be useful when handling tcp connections. Tcp does not listen and
dial on the same port by default. Thus when receiving an observed address on a connection that
we initiated, it will contain our dialing port, not our listening port. We need to take the ip
address or dns address from the observed address and the port from the original address.</p>
<p>This is a mixed-mode translation, i.e. an IPv4 / DNS4 address may be replaced by an IPv6 / DNS6
address and vice versa.</p>
<p>If the first <a href="../multiaddr/enum.Protocol.html" title="enum libp2p::multiaddr::Protocol"><code>Protocol</code></a>s are not IP addresses, <code>None</code> is returned instead.</p>
</div></details></section></div></main></body></html>